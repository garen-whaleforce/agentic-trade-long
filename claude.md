# Agentic Trade Long - Claude Code é–‹ç™¼æŒ‡å—

## é‡è¦è¦å‰‡ (CRITICAL RULES)

### 1. ç¦æ­¢å·çœ‹ç­”æ¡ˆ (NO LOOKAHEAD)

**çµ•å°ç¦æ­¢ä½¿ç”¨æœªä¾†è³‡è¨Šé€²è¡Œåˆ†ææˆ–å›æ¸¬**

```
âŒ ç¦æ­¢è¡Œç‚º:
- ä½¿ç”¨è²¡å ±å…¬å¸ƒæ—¥ä¹‹å¾Œçš„åƒ¹æ ¼è³‡æ–™é€²è¡Œæ±ºç­–
- åœ¨å›æ¸¬ä¸­ä½¿ç”¨ transcript_date ä¹‹å¾Œçš„ä»»ä½•è³‡è¨Š
- è¨ˆç®— T+30 å›å ±æ™‚ä½¿ç”¨å°šæœªç™¼ç”Ÿçš„åƒ¹æ ¼

âœ… æ­£ç¢ºåšæ³•:
- è¨­ç½®ç’°å¢ƒè®Šæ•¸ LOOKAHEAD_ASSERTIONS=true
- æ‰€æœ‰åˆ†æå¿…é ˆæä¾› transcript_date
- ä½¿ç”¨ as_of_date åš´æ ¼éæ¿¾æ­·å²è³‡æ–™
```

ä»£ç¢¼ä¸­çš„ä¿è­·æ©Ÿåˆ¶:
```python
# agentic_rag_bridge.py
lookahead_assertions = os.environ.get("LOOKAHEAD_ASSERTIONS", "").lower() in ("1", "true", "yes", "on")
if lookahead_assertions and not transcript_date:
    raise AgenticRagBridgeError("LOOKAHEAD PROTECTION: transcript_date is REQUIRED")
```

### 2. ç¦æ­¢éåº¦æ“¬åˆ (NO OVERFITTING)

**ç­–ç•¥åƒæ•¸èª¿æ•´å¿…é ˆéµå¾ª Tune/Validate/OOS ä¸‰æ®µå¼é©—è­‰**

```
è³‡æ–™åˆ†å‰²:
â”œâ”€â”€ Tune Set (2019-2023): åƒæ•¸èª¿æ•´
â”œâ”€â”€ Validate Set (2024 H1): é©—è­‰èª¿æ•´æ•ˆæœ
â””â”€â”€ Out-of-Sample (2024 H2+): æœ€çµ‚è©•ä¼°ï¼Œç¦æ­¢å›é ­èª¿åƒ

âŒ ç¦æ­¢è¡Œç‚º:
- åœ¨ OOS çµæœä¸å¥½æ™‚å›é ­èª¿æ•´åƒæ•¸
- é‡å°ç‰¹å®šè‚¡ç¥¨/å­£åº¦èª¿æ•´è¦å‰‡
- å¢åŠ ç‰¹ä¾‹è™•ç† (special case hacking)

âœ… æ­£ç¢ºåšæ³•:
- æ‰€æœ‰åƒæ•¸èª¿æ•´åªèƒ½åœ¨ Tune Set é€²è¡Œ
- é©—è­‰çµæœä¸å¥½æ™‚ï¼Œé‡æ–°æ€è€ƒç­–ç•¥é‚è¼¯è€Œéå¾®èª¿åƒæ•¸
- OOS çµæœå³ç‚ºæœ€çµ‚çµæœï¼Œç„¡è«–å¥½å£
```

### 3. ç¸¾æ•ˆæŒ‡æ¨™å¿…é ˆä½¿ç”¨ Whaleforce Skills (MANDATORY)

**ç¦æ­¢è‡ªè¡Œè¨ˆç®— ARR/MDD/Sharpeï¼Œå¿…é ˆä½¿ç”¨æŒ‡å®š Skills**

```
âŒ ç¦æ­¢è¡Œç‚º:
- è‡ªå·±å¯« Sharpe ratio è¨ˆç®—å…¬å¼
- æ‰‹å‹•è¨ˆç®—å¹´åŒ–å ±é…¬ç‡
- è‡ªè¡Œè¨ˆç®—æœ€å¤§å›æ’¤

âœ… æ­£ç¢ºåšæ³•:
- ä½¿ç”¨ /backtester-api é€²è¡Œå›æ¸¬
- ä½¿ç”¨ /performance-metrics è¨ˆç®—ç¸¾æ•ˆæŒ‡æ¨™
- ä½¿ç”¨ /postgres-database æŸ¥è©¢æ­·å²åƒ¹æ ¼
```

### 4. LLM æ¨¡å‹æŒ‡å®š (MODEL SPECIFICATION)

**å¿…é ˆä½¿ç”¨ LiteLLM Proxy æŒ‡å®šçš„æ¨¡å‹**

```python
# é è¨­æ¨¡å‹é…ç½® (utils/config.py)
MAIN_MODEL = "cli-gpt-5.2-high"  # ä¸»ä»£ç†æ¨¡å‹ (GPT-5.2 é«˜é…ç½®)
HELPER_MODEL = "gpt-4o-mini"     # è¼”åŠ©ä»£ç†æ¨¡å‹ (è¼•é‡å¿«é€Ÿ)

# LiteLLM ç«¯é»
LITELLM_ENDPOINT = "https://litellm.whaleforce.dev"
```

å¯ç”¨æ¨¡å‹ (LiteLLM æ”¯æ´):

**GPT-5 ç³»åˆ—** (æ³¨æ„: åªæ”¯æ´ temperature=1)
- `gpt-5.2` / `gpt-5.1` / `gpt-5` - æ¨™æº–ç‰ˆ
- `gpt-5-mini` / `gpt-5-nano` - è¼•é‡ç‰ˆ
- `cli-gpt-5.2-high` - CLI é«˜é…ç½®ç‰ˆ (ç›®å‰ MAIN_MODEL)

**GPT-4 ç³»åˆ—**
- `gpt-4o` / `gpt-4o-mini` - é€šç”¨ç‰ˆ (ç›®å‰ HELPER_MODEL)

**Reasoning æ¨¡å¼**
- `o3` / `o3-batch` - éœ€ä½¿ç”¨ Responses API

**Claude**
- `claude-opus-4.5` / `claude-sonnet-4.5`

**Gemini**
- `gemini-3-pro-preview` / `gemini-3-flash-preview`

---

## ç³»çµ±æ¶æ§‹

### å¤šä»£ç†åˆ†ææµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        API Request                                   â”‚
â”‚                    POST /api/analyze                                 â”‚
â”‚              {symbol, year, quarter, date}                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     analysis_engine.py                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 1. å–å¾— Transcript (FMP API)                                 â”‚   â”‚
â”‚  â”‚ 2. å–å¾— Market Anchors (PostgreSQL)                         â”‚   â”‚
â”‚  â”‚    - eps_surprise                                            â”‚   â”‚
â”‚  â”‚    - earnings_day_return                                     â”‚   â”‚
â”‚  â”‚    - pre_earnings_5d_return                                  â”‚   â”‚
â”‚  â”‚ 3. å‘¼å« agentic_rag_bridge                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   agentic_rag_bridge.py                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ MainAgent.run()                                              â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ extract(): å¾ transcript æå–äº‹å¯¦                      â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ delegate(): å°‡äº‹å¯¦åˆ†æ´¾çµ¦å°ˆé–€ä»£ç†                       â”‚   â”‚
â”‚  â”‚   â””â”€â”€ summarise(): å½™ç¸½å„ä»£ç†çµæœ                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼           â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Comparative â”‚ â”‚ Historical  â”‚ â”‚ Historical          â”‚
â”‚ Agent       â”‚ â”‚ Earnings    â”‚ â”‚ Performance         â”‚
â”‚             â”‚ â”‚ Agent       â”‚ â”‚ Agent               â”‚
â”‚ åŒæ¥­æ¯”è¼ƒ    â”‚ â”‚ æ­·å²è²¡å ±    â”‚ â”‚ æ­·å²è‚¡åƒ¹è¡¨ç¾        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Trade Signal Generation                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ _compute_trade_long()                                        â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚ 7-TIER ARCHITECTURE:                                         â”‚   â”‚
â”‚  â”‚   D7_CORE   â†’ Direction â‰¥ 7, soft_veto â‰¤ 1, 100% size       â”‚   â”‚
â”‚  â”‚   D6_STRICT â†’ Direction = 6, soft_veto â‰¤ 1, 75% size        â”‚   â”‚
â”‚  â”‚   D5_GATED  â†’ Direction â‰¥ 5, momentum aligned, 50% size     â”‚   â”‚
â”‚  â”‚   D4_ENTRY  â†’ Direction â‰¥ 4, confirmation required          â”‚   â”‚
â”‚  â”‚   D4_OPP    â†’ Direction â‰¥ 4, looser gates (DISABLED)        â”‚   â”‚
â”‚  â”‚   D3_WIDE   â†’ Direction â‰¥ 3, strict confirmation (DISABLED) â”‚   â”‚
â”‚  â”‚   D3_PROBE  â†’ Probe tier (DISABLED)                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     v10_scoring.py                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ V10 Enhanced Scoring (ChatGPT Pro 10-iteration optimized)   â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚ 1. compute_v10_utility()                                     â”‚   â”‚
â”‚  â”‚    - reliability_score                                       â”‚   â”‚
â”‚  â”‚    - evidence_score                                          â”‚   â”‚
â”‚  â”‚    - contradiction_score                                     â”‚   â”‚
â”‚  â”‚    - reaction_term (momentum aligned)                        â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚ 2. compute_v10_position_size()                               â”‚   â”‚
â”‚  â”‚    - Tier-specific Kelly multipliers                         â”‚   â”‚
â”‚  â”‚    - Soft veto penalty (0.90x per veto)                      â”‚   â”‚
â”‚  â”‚    - POSITION_SCALE = 5.5x                                   â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚ Output: position_size (5% - 55%)                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Final Output                                  â”‚
â”‚  {                                                                   â”‚
â”‚    "trade_long": true,                                              â”‚
â”‚    "trade_long_tier": "D7_CORE",                                    â”‚
â”‚    "position_size": 0.12,                                           â”‚
â”‚    "direction_score": 8,                                            â”‚
â”‚    "risk_code": "low",                                              â”‚
â”‚    "market_anchors": {...},                                         â”‚
â”‚    "long_eligible_json": {...}                                      â”‚
â”‚  }                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Veto æ©Ÿåˆ¶

```
Hard Vetoes (ç¡¬æ€§å¦æ±º - ç›´æ¥ Block):
â”œâ”€â”€ GuidanceCut: å…¬å¸ä¸‹èª¿æŒ‡å¼•

Soft Vetoes (è»Ÿæ€§å¦æ±º - æ¸›å°‘å€‰ä½):
â”œâ”€â”€ DemandSoftness: éœ€æ±‚ç–²è»Ÿ
â”œâ”€â”€ MarginWeakness: æ¯›åˆ©ç‡ä¸‹é™
â”œâ”€â”€ VisibilityWorsening: èƒ½è¦‹åº¦æƒ¡åŒ–
â””â”€â”€ CashBurn: ç¾é‡‘æ¶ˆè€—
```

### è¡Œæ¥­é™åˆ¶

```python
# D6 å±¤ç´šå°é–
D6_BLOCKED_SECTORS = ["Technology", "Healthcare"]

# D7 å±¤ç´šå°é–
D7_BLOCKED_SECTORS = ["Real Estate"]
```

---

## å¯ç”¨ Skills

### è³‡æ–™æŸ¥è©¢é¡

#### /postgres-database
PostgreSQL è³‡æ–™åº«æŸ¥è©¢ï¼ŒåŒ…å«è‚¡åƒ¹ã€è²¡å ±ã€å…¬å¸è³‡è¨Š

```python
# æŸ¥è©¢è‚¡åƒ¹
SELECT symbol, date, close FROM historical_prices
WHERE symbol = 'AAPL' AND date >= '2024-01-01'

# æŸ¥è©¢ EPS surprise
SELECT * FROM earnings_surprises WHERE symbol = 'AAPL'
```

#### /earningcall-api
è²¡å ±é›»è©±æœƒè­° Transcript æœå‹™

```bash
# å–å¾— transcript
curl "https://earningcall.gpu5090.whaleforce.dev/api/company/AAPL/transcript?year=2024&quarter=4&level=2"
```

#### /neo4j-knowledge-graph
Neo4j çŸ¥è­˜åœ–è­œï¼Œè²¡å ±äº‹å¯¦å’Œå…¬å¸é—œä¿‚

#### /sec-filings
SEC æ–‡ä»¶æŸ¥è©¢ (10-K, 10-Q)

#### /minio-storage
13F æ©Ÿæ§‹æŒè‚¡è³‡æ–™ (S3-compatible)

### ç¸¾æ•ˆè¨ˆç®—é¡ (å¿…é ˆä½¿ç”¨)

#### /backtester-api
æŠ•è³‡çµ„åˆå›æ¸¬æœå‹™ - **ARR/MDD/Sharpe å¿…é ˆä½¿ç”¨æ­¤æœå‹™**

```python
# å›æ¸¬åƒæ•¸
{
    "symbols": ["AAPL", "MSFT"],
    "start_date": "2020-01-01",
    "end_date": "2024-12-31",
    "initial_capital": 100000,
    "rebalance_freq": "quarterly"
}
```

#### /performance-metrics
å–®ä¸€è‚¡ç¥¨ç¸¾æ•ˆæŒ‡æ¨™è¨ˆç®—

```bash
# è¨ˆç®— AAPL çš„ Sharpe ratio
/performance-metrics AAPL 2024-01-01 2024-12-31
```

### LLM æœå‹™é¡

#### /litellm
çµ±ä¸€ LLM Proxyï¼Œæ”¯æ´å¤šç¨®æ¨¡å‹

```python
# å¯ç”¨æ¨¡å‹
models = ["gpt-5", "gpt-5-mini", "claude-sonnet-4", "claude-opus-4-5", "gemini-3-pro"]
```

#### /chatgpt-pro-api
ChatGPT Pro æ·±åº¦åˆ†ææœå‹™ (Chrome automation)

#### /multi-model-aggregator
å¤šæ¨¡å‹èšåˆæœå‹™ (GPT-5 + Claude + Gemini ä¸¦è¡Œ)

### å·¥å…·é¡

#### /cli-usage
Claude Code / Codex ä½¿ç”¨é‡æª¢æŸ¥

#### /healthy-dashboard
æœå‹™å¥åº·ç‹€æ…‹ç›£æ§

#### /sync-skills
åŒæ­¥ Skills åˆ°æœ¬åœ°

---

## æª”æ¡ˆçµæ§‹

```
agentic-trade-long/
â”œâ”€â”€ main.py                      # FastAPI å…¥å£
â”œâ”€â”€ analysis_engine.py           # åˆ†æå¼•æ“æ ¸å¿ƒ
â”œâ”€â”€ agentic_rag_bridge.py        # API èˆ‡ RAG æ©‹æ¥ (7-TIER æ¶æ§‹)
â”œâ”€â”€ v10_scoring.py               # V10 Enhanced è©•åˆ†ç³»çµ±
â”œâ”€â”€ pro_iteration.py             # ChatGPT Pro è¿­ä»£å„ªåŒ–
â”œâ”€â”€ pg_client.py                 # PostgreSQL å®¢æˆ¶ç«¯
â”œâ”€â”€ fmp_client.py                # FMP é‡‘èæ•¸æ“š API
â”œâ”€â”€ storage.py                   # å„²å­˜å±¤
â”œâ”€â”€ credentials.json             # API æ†‘è­‰ (å‹¿æäº¤)
â”œâ”€â”€ .env                         # ç’°å¢ƒè®Šæ•¸ (å‹¿æäº¤)
â”‚
â”œâ”€â”€ EarningsCallAgenticRag/      # å¤šä»£ç† RAG æ ¸å¿ƒ
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â”œâ”€â”€ mainAgent.py         # ä¸»å”èª¿å™¨
â”‚   â”‚   â”œâ”€â”€ comparativeAgent.py  # åŒæ¥­æ¯”è¼ƒä»£ç†
â”‚   â”‚   â”œâ”€â”€ historicalEarningsAgent.py
â”‚   â”‚   â”œâ”€â”€ historicalPerformanceAgent.py
â”‚   â”‚   â”œâ”€â”€ agent_factory.py     # ä»£ç†å·¥å» 
â”‚   â”‚   â””â”€â”€ prompts/             # Prompt æ¨¡æ¿
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ config.py            # å…¨åŸŸè¨­å®š
â”‚   â”‚   â”œâ”€â”€ llm.py               # LLM å·¥å…·
â”‚   â”‚   â””â”€â”€ token_tracker.py     # Token è¿½è¹¤
â”‚   â””â”€â”€ orchestrator_parallel_facts.py
â”‚
â”œâ”€â”€ backtest_tools/              # å›æ¸¬å·¥å…·
â”œâ”€â”€ services/                    # Whaleforce æœå‹™å®¢æˆ¶ç«¯
â””â”€â”€ paper_trading/               # ç´™ä¸Šäº¤æ˜“ (æœªå®Œæˆ)
```

---

## ç’°å¢ƒè®Šæ•¸

```bash
# LiteLLM è¨­å®š (å¿…é ˆ)
LITELLM_ENDPOINT=https://litellm.whaleforce.dev
LITELLM_API_KEY=your_key

# æ¨¡å‹è¨­å®š
MAIN_MODEL=cli-gpt-5.2-high
HELPER_MODEL=gpt-4o-mini

# Neo4j è¨­å®š
NEO4J_URI=bolt://...
NEO4J_USERNAME=neo4j
NEO4J_PASSWORD=...

# Lookahead ä¿è­· (å›æ¸¬æ™‚å¿…é ˆé–‹å•Ÿ)
LOOKAHEAD_ASSERTIONS=true

# FMP API
FMP_API_KEY=your_key
```

---

## é–‹ç™¼æ³¨æ„äº‹é …

### æ–°å¢äº¤æ˜“è¦å‰‡æ™‚

1. **å…ˆåœ¨ Tune Set (2019-2023) é©—è­‰**
2. **åœ¨ Validate Set (2024 H1) ç¢ºèª**
3. **ç¦æ­¢æ ¹æ“š OOS çµæœèª¿æ•´**

### ä¿®æ”¹è©•åˆ†é‚è¼¯æ™‚

1. **ä¿æŒå‘å¾Œç›¸å®¹**
2. **è¨˜éŒ„ç‰ˆæœ¬è™Ÿ** (strategy_version)
3. **ä½¿ç”¨ A/B æ¸¬è©¦æ¯”è¼ƒ**

### ä½¿ç”¨ç¸¾æ•ˆæŒ‡æ¨™æ™‚

```python
# âŒ éŒ¯èª¤åšæ³•
sharpe = returns.mean() / returns.std() * np.sqrt(252)

# âœ… æ­£ç¢ºåšæ³•
# ä½¿ç”¨ /backtester-api æˆ– /performance-metrics skill
```

---

## API ç«¯é»

| ç«¯é» | æ–¹æ³• | èªªæ˜ |
|------|------|------|
| `/api/analyze` | POST | åˆ†æå–®ä¸€è²¡å ± |
| `/api/batch-analyze` | POST | æ‰¹æ¬¡åˆ†æ |
| `/api/earnings-calendar/today` | GET | ä»Šæ—¥è²¡å ±æ—¥æ›† |
| `/api/transcript-dates` | GET | å–å¾— transcript æ—¥æœŸ |
| `/api/services/health` | GET | æœå‹™å¥åº·æª¢æŸ¥ |
| `/api/backtest/run` | POST | åŸ·è¡Œå›æ¸¬ |

---

## åŸ·è¡Œæ–¹å¼

```bash
# é–‹ç™¼æ¨¡å¼
cd /Users/garen.lee/Coding/agentic-trade-long
python main.py

# Docker æ¨¡å¼
docker build -t agentic-trade-long .
docker run -p 8000:8000 --env-file .env agentic-trade-long
```

---

## ChatGPT Pro è¿­ä»£å„ªåŒ–æ­·å²

**æœ€æ–°æ›´æ–°**: 2026-01-19
**ç‹€æ…‹**: Phase 1 Complete âœ…
**æœ€ä½³é…ç½®**: Iteration 1

### å„ªåŒ–æˆæœç¸½è¦½

ç¶“é 5 æ¬¡ ChatGPT Pro ç³»çµ±åŒ–è¿­ä»£å„ªåŒ–ï¼Œç­–ç•¥å–å¾—é¡¯è‘—æ”¹é€²ï¼š

| æŒ‡æ¨™ | åŸºæº–ç·š | æœ€ä½³çµæœ (Iter 1) | æ”¹é€²å¹…åº¦ | ç›®æ¨™ | é”æˆç‹€æ…‹ |
|------|--------|------------------|----------|------|----------|
| **CAGR** | 14.16% | **20.05%** | +5.89% (+41.6%) | >35% | ğŸŸ¡ éƒ¨åˆ†é”æˆ |
| **Sharpe Ratio** | 1.91 | 1.53 | -0.38 (-19.9%) | >2.0 | ğŸ”´ æœªé”æˆ |
| **Win Rate** | 86.11% | **72.26%** | -13.85% | 70-75% | âœ… é”æˆ |
| **äº¤æ˜“æ¬¡æ•¸** | 180 | **328** | +148 (+82.2%) | å¢åŠ  | âœ… é”æˆ |
| **å¹³å‡æ›éšª** | 23.03% | **43.89%** | +20.86% (+90.6%) | æé«˜ | âœ… é”æˆ |

### æœ€ä½³é…ç½®åƒæ•¸ (Iteration 1)

**ç”Ÿç”¢ç’°å¢ƒå»ºè­°é…ç½®**:

```python
# Tier å•Ÿç”¨ç‹€æ…‹
D7_ENABLED = True
D6_ENABLED = True
D5_ENABLED = True  # âœ… å¾ False æ”¹ç‚º True
D4_ENABLED = True  # âœ… å¾ False æ”¹ç‚º True
D3_ENABLED = False  # âš ï¸ ä¿æŒé—œé–‰ï¼Œå“è³ªä¸è¶³

# D7 CORE åƒæ•¸
D7_MIN_DAY_RET = 1.0  # âœ… å¾ 1.5% æ”¾å¯¬åˆ° 1.0%
D7_REQUIRE_EPS_POS = True
D7_BLOCKED_SECTORS = ["Real Estate"]

# D6 STRICT åƒæ•¸
D6_MIN_EPS_SURPRISE = 0.5  # ä¿æŒ 0.5%
D6_REQUIRE_LOW_RISK = False  # âœ… å¾ True æ”¹ç‚º False
D6_EXCLUDE_SECTORS = []  # âœ… ç§»é™¤ Technology é™åˆ¶

# é¢¨éšªæ§åˆ¶åƒæ•¸
RISK_DAY_LOW = -5.0  # âœ… å¾ -3% æ”¾å¯¬åˆ° -5%
RISK_EPS_MISS = 0.0
RISK_RUNUP_HIGH = 15.0

# å€‰ä½ç®¡ç†
MAX_POSITIONS = 10  # âœ… å¾ 12 æ”¹ç‚º 10ï¼ˆæ›´å¥½çš„åˆ†æ•£ï¼‰
POSITION_SIZE = 0.10  # 10% æ¯å€‹å€‰ä½
```

### é—œéµç™¼ç¾

#### âœ… æœ‰æ•ˆçš„æ”¹è®Š
1. **å•Ÿç”¨ D4/D5 å±¤ç´š** - å¢åŠ  148 æ¬¡äº¤æ˜“ï¼Œå¤§å¹…æå‡ CAGR
2. **æ”¾å¯¬ D7 æ—¥å ±é…¬é–€æª»** (1.5% â†’ 1.0%) - æ›´å¤šé«˜å“è³ªæ©Ÿæœƒ
3. **ç§»é™¤ç§‘æŠ€æ¥­é™åˆ¶** - ç§‘æŠ€è‚¡æœ‰è‰¯å¥½æ©Ÿæœƒ
4. **æ”¾å¯¬é¢¨éšªéæ¿¾å™¨** (day_low: -3% â†’ -5%) - å¹³è¡¡é¢¨éšªèˆ‡æ©Ÿæœƒ
5. **æ¸›å°‘åŒæ™‚æŒå€‰** (12 â†’ 10) - æ›´å¥½çš„åˆ†æ•£æ•ˆæœ

#### âŒ ç„¡æ•ˆçš„æ”¹è®Š
1. **éåº¦æ”¶ç·Š D4 éæ¿¾å™¨** (Iter 2) - ç§»é™¤äº†å„ªè³ªäº¤æ˜“
2. **é‡æ–°å•Ÿç”¨ D6 ä½é¢¨éšªè¦æ±‚** (Iter 2) - éæ–¼é™åˆ¶
3. **éåº¦æ”¾å¯¬ HIGH_RISK** (Iter 3) - å“è³ªä¸‹é™
4. **å•Ÿç”¨ D3 å±¤ç´š** (Iter 3) - ä¿¡è™Ÿå“è³ªä¸è¶³
5. **å¢åŠ å–®ä¸€å€‰ä½å¤§å°** (Iter 4) - æ¸›å°‘äº¤æ˜“æ¬¡æ•¸ï¼Œå ±é…¬ä¸‹é™

#### æ ¸å¿ƒæ´å¯Ÿï¼šThe Trade-off

```
ä¿å®ˆç­–ç•¥ (åŸºæº–ç·š)           å‡è¡¡ç­–ç•¥ (Iteration 1)
â”œâ”€ Win Rate: 86%             â”œâ”€ Win Rate: 72%
â”œâ”€ CAGR: 14%                 â”œâ”€ CAGR: 20%
â”œâ”€ Sharpe: 1.91              â”œâ”€ Sharpe: 1.53
â”œâ”€ æ³¢å‹•ç‡: 7%                â”œâ”€ æ³¢å‹•ç‡: 12%
â””â”€ æ›éšª: 23%                 â””â”€ æ›éšª: 44%

è³‡æœ¬åˆ©ç”¨ä¸è¶³               æ›´å¥½çš„å ±é…¬é¢¨éšªå¹³è¡¡
```

**çµè«–**: ä»¥ç•¶å‰ LLM ä¿¡è™Ÿå“è³ªï¼Œ**ç„¡æ³•åŒæ™‚é”æˆ 35% CAGR å’Œ 2.0 Sharpe**ã€‚å¿…é ˆåœ¨å ±é…¬èˆ‡é¢¨éšªä¹‹é–“å–æ¨ã€‚

### è¿­ä»£æ­·ç¨‹ç°¡è¡¨

| è¿­ä»£ | ä¸»è¦æ”¹è®Š | CAGR | Sharpe | çµæœ |
|------|---------|------|--------|------|
| Baseline | v1.1-live-safe | 14.16% | 1.91 | éæ–¼ä¿å®ˆ |
| **Iteration 1** | **å•Ÿç”¨ D4/D5, æ”¾å¯¬éæ¿¾å™¨** | **20.05%** | **1.53** | **âœ… æœ€ä½³** |
| Iteration 2 | æ”¶ç·Š D4, é‡å•Ÿ D6 é¢¨éšª | 17.43% | 1.41 | âŒ é€€æ­¥ |
| Iteration 3 | æ”¾å¯¬ HIGH_RISK, å•Ÿç”¨ D3 | 19.01% | 1.40 | âŒ é€€æ­¥ |
| Iteration 4 | æ¸¬è©¦å€‰ä½å¤§å° (8/6 pos) | 19.57% | 1.45 | âŒ é€€æ­¥ |
| Iteration 5 | æœ€çµ‚åˆ†æèˆ‡ç­–ç•¥å»ºè­° | - | - | âœ… å®Œæˆ |

### å¾ŒçºŒæ”¹é€²è·¯å¾‘

#### ç¬¬ä¸€éšæ®µï¼šç«‹å³éƒ¨ç½² (æœ¬é€±)
- [x] éƒ¨ç½² Iteration 1 é…ç½®
- [ ] è¨­å®šç›£æ§å„€è¡¨æ¿
- [ ] å•Ÿå‹•ç´™ä¸Šäº¤æ˜“é©—è­‰

#### ç¬¬äºŒéšæ®µï¼šçŸ­æœŸæ”¹é€² (1-2 å€‹æœˆ)
- [ ] å¯¦æ–½å‹•æ…‹å€‰ä½åˆ†é… (D7: 12-15%, D6: 8-10%, D5/D4: 5-7%)
- [ ] å¢åŠ  D4/D5 å“è³ªéæ¿¾å™¨
- [ ] åŸ·è¡Œ walk-forward é©—è­‰

#### ç¬¬ä¸‰éšæ®µï¼šä¸­æœŸç ”ç™¼ (3-6 å€‹æœˆ)
- [ ] æå‡ LLM åˆ†æå“è³ªï¼ˆå…©éšæ®µåˆ†æã€ç½®ä¿¡åº¦è©•åˆ†ï¼‰
- [ ] å¢åŠ åŸºæœ¬é¢é ç¯©é¸
- [ ] æ¸¬è©¦ GPT-5.2 vs Claude Opus 4.5

#### ç¬¬å››éšæ®µï¼šé•·æœŸå‰µæ–° (6-12 å€‹æœˆ)
- [ ] å¤šæ™‚é–“é€±æœŸç­–ç•¥ (D7: 45-60 å¤©, D6: 30 å¤©, D4/D5: 15-20 å¤©)
- [ ] æ©Ÿå™¨å­¸ç¿’ä¿¡è™Ÿå¢å¼·
- [ ] ç­–ç•¥çµ„åˆç³»çµ±

### æ–‡ä»¶åƒè€ƒ

å®Œæ•´è¿­ä»£è¨˜éŒ„ä½æ–¼ `chatgpt_pro_iterations/` ç›®éŒ„ï¼š

- [`ITERATION_TRACKER.md`](chatgpt_pro_iterations/ITERATION_TRACKER.md) - å¿«é€Ÿè¿½è¹¤å„€è¡¨æ¿
- [`ITERATIONS_SUMMARY.md`](chatgpt_pro_iterations/ITERATIONS_SUMMARY.md) - åŸ·è¡Œæ‘˜è¦
- [`iteration_5_final_analysis.md`](chatgpt_pro_iterations/iteration_5_final_analysis.md) - ç­–ç•¥è·¯ç·šåœ–
- `iteration_1_*.md` ~ `iteration_4_*.md` - å„è¿­ä»£è©³ç´°è¨˜éŒ„

### ç›£æ§æŒ‡æ¨™

**å³æ™‚äº¤æ˜“ KPIï¼ˆæ¯é€±ç›£æ§ï¼‰**:

| æŒ‡æ¨™ | ç›®æ¨™ | è­¦å‘Šé–€æª» | ç†”æ–·æ©Ÿåˆ¶ |
|------|------|----------|----------|
| 12 é€±æ»¾å‹• Sharpe | >1.5 | <1.2 | <0.8 |
| 20 äº¤æ˜“æ»¾å‹•å‹ç‡ | 70-75% | <65% | <60% |
| æœ€å¤§å›æ’¤ | <-20% | -25% | -30% |
| å›æ¸¬åå·® | <5% CAGR | <10% CAGR | >15% CAGR |

---

## Rounds 6-10 ChatGPT Pro æœ€çµ‚å„ªåŒ– (2026-01-19)

**ç‹€æ…‹**: ğŸ”„ **IMPLEMENTATION IN PROGRESS**
**ç›®æ¨™**: CAGR >35%, Sharpe >2.0
**æ–¹æ³•**: 5 è¼ªå¿«é€Ÿè¿­ä»£å„ªåŒ–ï¼Œå…¨é¢å„ªåŒ–ç³»çµ±æ‰€æœ‰å­ç³»çµ±

### å„ªåŒ–ç¯„åœ

| Round | é‡é»é ˜åŸŸ | ç‹€æ…‹ | é æœŸè²¢ç» |
|-------|----------|------|----------|
| **Round 6** | Prompt å„ªåŒ– | âœ… å®Œæˆ | CAGR +10-15%, Sharpe +0.2-0.4 |
| **Round 7** | Veto é‚è¼¯ & Helper Agents | âœ… Prompts å®Œæˆ | å‡é™½æ€§ -15-20% |
| **Round 8** | Tier Gates & Position Sizing | â³ å¾…å¯¦æ–½ | D7/D6 >60%, CAGR +4-6% |
| **Round 9** | äº¤å‰é©—è­‰ & äº‹å¯¦å§”æ´¾ | â³ å¾…å¯¦æ–½ | å‡é™½æ€§ -15-20% |
| **Round 10** | æ•´åˆ & åƒæ•¸å¾®èª¿ | â³ å¾…å¯¦æ–½ | Sharpe >2.0 ç©©å®š |

### å·²å¯¦æ–½è®Šæ›´

#### âœ… Phase 1: Prompt å„ªåŒ– (2026-01-19)

**Main Agent System Message** (Round 6):
- Direction Score æ˜ç¢ºæ ¡æº–ï¼ˆD9-10: >20%, D7-8: 10-20%, D<6: <5%ï¼‰
- å¼·èª¿"çœŸæ­£é©šå–œ" vs å·²å®šåƒ¹çµæœ
- æ›´æ¸…æ™°å€åˆ†å¼·/ä¸­/å¼±ä¿¡è™Ÿ

**Extraction System Message** (Round 6):
- æ–°äº‹å¯¦é¡åˆ¥: Surprise, Tone, Market Reaction
- æ¯å€‹äº‹å¯¦è©•ä¼° conviction level
- æ›´æ¸…æ™°çš„é©šå–œå®šç¾©ï¼ˆ>10% åé›¢å…±è­˜ï¼‰

**Comparative Agent** (Round 7):
- ç›¸å°é©šå–œåˆ†æï¼ˆå…¬å¸ vs åŒæ¥­ï¼‰
- æ˜ç¢ºå€åˆ†è¡Œæ¥­å‹•èƒ½ vs å…¬å¸ç‰¹å®šå„ªå‹¢
- Impact Score 0-10 æ ¡æº–

**Historical Earnings Agent** (Round 7):
- æ™‚é–“åŠ æ¬Šï¼ˆæœ€è¿‘ 2 å­£ 1.5xï¼‰
- Sandbagging æª¢æ¸¬
- ä¿¡ç”¨è¶¨å‹¢è©•ä¼° (Impact Score -2 to +2)

### å¾…å¯¦æ–½è®Šæ›´

#### â³ Phase 2-6: æ ¸å¿ƒé‚è¼¯å„ªåŒ–

**Veto System** (Round 7):
- 3 å€‹æ–° hard vetoes
- å¯è®Š soft veto æ¬Šé‡
- Hidden guidance cut æª¢æ¸¬

**Tier Gates** (Round 8):
- EPS surprise æ•´åˆï¼ˆD7: >12%, D6: >5%, D4: â‰¥8%ï¼‰
- æ–° D8_MEGA tierï¼ˆeps_surprise > 20%ï¼‰
- è¡Œæ¥­å°é–æ¢ä»¶ç§»é™¤

**Position Sizing** (Round 8 + 10):
- POSITION_SCALE: 5.5 â†’ 5.0
- MAX_POSITION_SIZE: 55% â†’ 40%
- æ³¢å‹•æ€§æ„ŸçŸ¥èª¿æ•´
- EPS surprise boost

**Cross-Validation** (Round 9):
- è¡çªæª¢æ¸¬ï¼ˆpenalty -1 to -0.5ï¼‰
- æ™ºèƒ½äº‹å¯¦è·¯ç”±
- ä»£ç†è¼¸å‡ºæ¨™æº–åŒ–
- äº‹å¯¦å»é‡ & å„ªå…ˆç´š

### é æœŸæœ€çµ‚è¡¨ç¾

| æŒ‡æ¨™ | Baseline (Iter 1) | é æœŸ (Rounds 6-10) | ç›®æ¨™ | é”æˆé æ¸¬ |
|------|-------------------|-------------------|------|----------|
| **CAGR** | 20.05% | **32-35%** | >35% | âš ï¸ æ¥è¿‘ |
| **Sharpe** | 1.53 | **2.1-2.4** | >2.0 | âœ… è¶…è¶Š |
| **Win Rate** | 72.26% | **72-76%** | 70-75% | âœ… é”æˆ |
| **D7/D6 Ratio** | 45.8% | **>65%** | >55% | âœ… è¶…è¶Š |

### å¯¦æ–½æ–‡æª”

å®Œæ•´æ–‡æª”ä½æ–¼ `chatgpt_pro_iterations/` ç›®éŒ„ï¼š
- [`ROUNDS_6_10_MASTER_SUMMARY.md`](chatgpt_pro_iterations/ROUNDS_6_10_MASTER_SUMMARY.md) - ç¸½çµæ–‡æª”
- `round6_*.md` ~ `round10_*.md` - å„è¼ªè©³ç´°è¨˜éŒ„ï¼ˆinput/output/implementation_planï¼‰
- é ä¼°å‰©é¤˜å¯¦æ–½æ™‚é–“: 25-40 hours

**ä¸‹ä¸€æ­¥**: å®Œæˆ Rounds 7-10 æ ¸å¿ƒé‚è¼¯å¯¦æ–½ â†’ å°è¦æ¨¡æ¸¬è©¦ â†’ å®Œæ•´å›æ¸¬ (2017-2024)

---

## Gemini 4000 æ¨£æœ¬å›æ¸¬åˆ†æ (2026-01-19)

**ç‹€æ…‹**: ğŸ”´ **CRITICAL ISSUES FOUND**
**æ¨¡å‹**: gemini-3-flash-preview + gpt-4o-mini
**æ¨£æœ¬æ•¸**: 4000 (2017-2025)
**åŸ·è¡Œæ™‚é–“**: 10.01 å°æ™‚
**æˆæœ¬**: $11.40 ($0.00285/ç­†)

### åŸ·è¡Œæ‘˜è¦

#### âœ… æˆåŠŸæŒ‡æ¨™
- **ç©©å®šæ€§**: 99.75% æˆåŠŸç‡ (åƒ… 10 ç­†éŒ¯èª¤)
- **é€Ÿåº¦**: 9.03ç§’/ç­†ï¼Œgemini æ¯” gpt-5-mini å¿«ä¸”ä¾¿å®œ
- **æˆæœ¬**: å®Œå…¨ç¬¦åˆé ä¼°

#### ğŸ”´ åš´é‡å•é¡Œ
1. **ä¿¡è™Ÿç‡ç•°å¸¸**: 38.5% (é æœŸ 10-20%)
2. **D4_OPP æ°¾æ¿«**: 908/1541 ä¿¡è™Ÿ (58.9%)
3. **D6_STRICT ç¨€ç¼º**: åƒ… 6 å€‹ä¿¡è™Ÿ (0.4%)
4. **D7_CORE ä¸è¶³**: 72 å€‹ä¿¡è™Ÿ (4.7%)
5. **é…ç½®ç‰ˆæœ¬æ··äº‚**: æª¢æ¸¬åˆ° v34 (D8_MEGA) èˆ‡ v33 æ··åˆ

### Direction Score åˆ†ä½ˆ (3990 ç­†æˆåŠŸ)

| Score | æ•¸é‡ | ç™¾åˆ†æ¯” | å“è³ª |
|-------|------|--------|------|
| D9 | 1 | 0.0% | â­â­â­ |
| D8 | 39 | 1.0% | â­â­â­ |
| D7 | 256 | 6.4% | â­â­ |
| D6 | 409 | 10.3% | â­â­ |
| D5 | 372 | 9.3% | â­ |
| D4 | 2011 | 50.4% | --- |
| D3 | 867 | 21.7% | |
| D2 | 35 | 0.9% | |

**å“è³ªåˆ†å±¤**:
- D7+ (é«˜å“è³ª): 296 ç­† (7.4%) âœ… **ç¬¦åˆé æœŸ 7-10%**
- D6+ (å„ªè³ª): 705 ç­† (17.7%)
- D5+ (åˆæ ¼): 1077 ç­† (27.0%)

### Trade Signal ç•°å¸¸åˆ†æ

**ç¸½ä¿¡è™Ÿ**: 1541 ç­† (38.5%) âš ï¸ **é é«˜æ–¼é æœŸ 10-20%**

#### æŒ‰ Tier åˆ†é¡
```
D4_OPP:    908 ç­† (58.9%)  ğŸ”´ æœ€å¤š - æ‡‰è©²æ˜¯æ©Ÿæœƒæ€§ tier
D4_ENTRY:  381 ç­† (24.7%)
D8_MEGA:   125 ç­† (8.1%)   âš ï¸ æ–° tier (v34)
D7_CORE:    72 ç­† (4.7%)   ğŸŸ¡ åå°‘ - æ‡‰è©²æ˜¯ä¸»åŠ›
D5_GATED:   49 ç­† (3.2%)
D6_STRICT:   6 ç­† (0.4%)   ğŸ”´ éå°‘ - æ‡‰è©²æ˜¯ä¸»åŠ›
```

### Root Cause Analysis

#### å•é¡Œ 1: D4_OPP æ°¾æ¿« (å¯èƒ½æ€§ 90%)
**åŸå› **: D4_OPP gates æœªå¯¦æ–½æˆ–å¤±æ•ˆ
- ç¼ºå°‘ `momentum_aligned` æª¢æŸ¥
- `eps_surprise` é–€æª»éä½æˆ–æœªæª¢æŸ¥
- Veto æ©Ÿåˆ¶æœªæ­£ç¢ºæ‡‰ç”¨

**é æœŸè¡Œç‚º**:
```python
if direction_score >= 4:
    if momentum_aligned and eps_surprise >= 3.0 and soft_veto <= 2:
        return "D4_OPP"  # æ©Ÿæœƒæ€§ï¼Œæ‡‰è©²å¾ˆå°‘
```

**å¯¦éš›è¡Œç‚º**: D4_OPP æ¢ä»¶å¯èƒ½æ¯” D4_ENTRY æ›´å¯¬é¬†ï¼ˆéŒ¯èª¤ï¼‰

#### å•é¡Œ 2: D6_STRICT ç¨€ç¼º (å¯èƒ½æ€§ 80%)
**åŸå› **: D6_REQUIRE_LOW_RISK é‡æ–°å•Ÿç”¨
- v33 æ‡‰è¨­ç‚º `False`ï¼Œå¯èƒ½è¢«æ”¹å› `True`
- æˆ– D6_MIN_EPS_SURPRISE è¨­å®šéŒ¯èª¤ (5.0 è€Œé 0.5)
- è½‰æ›ç‡åƒ… 6/409 = 1.5%

#### å•é¡Œ 3: D7_CORE ä¸è¶³ (å¯èƒ½æ€§ 70%)
**åŸå› **: D7_MIN_DAY_RET é–€æª»éé«˜
- v33 æ‡‰è¨­ç‚º 1.0%ï¼Œå¯èƒ½è¢«è¨­ç‚º 2.0%
- æˆ– earnings_day_return æ•¸æ“šç¼ºå¤±ç‡é«˜
- è½‰æ›ç‡ 72/256 = 28.1%ï¼ˆä»åä½ï¼‰

#### å•é¡Œ 4: é…ç½®ç‰ˆæœ¬æ··äº‚ (ç¢ºå®šæ€§ 100%)
**ç™¼ç¾**: D8_MEGA å‡ºç¾ (125 å€‹ä¿¡è™Ÿ)
- D8_MEGA æ˜¯ v34 Rounds 6-10 æ–°å¢çš„ tier
- è¡¨ç¤ºä»£ç¢¼å·²éƒ¨åˆ†å¥—ç”¨ v34ï¼Œä½†æœªå®Œæ•´å¯¦æ–½
- æˆ– v34 changes æœ‰ bug

### é¢¨éšªè©•ä¼°

#### ğŸ”´ ç›´æ¥ä½¿ç”¨é¢¨éšª: **é«˜ - ä¸å»ºè­°äº¤æ˜“**

**å…·é«”é¢¨éšª**:
1. **ä¿¡è™Ÿå“è³ªæœªé©—è­‰**: D4_OPP å¯èƒ½å¤§é‡å‡é™½æ€§
2. **éåº¦åˆ†æ•£**: 1541 å€‹ä¿¡è™Ÿå¤ªå¤šï¼Œäº¤æ˜“æˆæœ¬ä¾µè•åˆ©æ½¤
3. **é…ç½®æ··äº‚**: v33 + v34 æ··åˆï¼Œè¡Œç‚ºä¸å¯é æ¸¬
4. **Backtest åå·®**: å¯èƒ½å­˜åœ¨ lookahead bias

**å»ºè­°æ“ä½œ**:
- **ç´™ä¸Šäº¤æ˜“**: é¸ 50-100 å€‹ä¿¡è™Ÿï¼Œé¿é–‹ D4_OPP
- **å°è¦æ¨¡æ¸¬è©¦**: åˆå§‹è³‡é‡‘ <5% ç¸½è³‡ç”¢
- **æŒçºŒç›£æ§**: 30 å¤©å¯¦éš›è¡¨ç¾ vs å›æ¸¬é æœŸ

### ç«‹å³è¡Œå‹•æ¸…å–® (P0 - ä»Šæ™šå®Œæˆ)

#### 1. é…ç½®è¨ºæ–·
```bash
# æª¢æŸ¥ç•¶å‰é…ç½®ç‰ˆæœ¬
grep -n "STRATEGY_VERSION\|v33\|v34" agentic_rag_bridge.py | head -20

# æª¢æŸ¥ D4_OPP gates
grep -A 30 "D4_OPP" agentic_rag_bridge.py | grep -E "momentum|eps_surprise|veto"

# æª¢æŸ¥ D6/D7 é…ç½®
grep -E "D6_REQUIRE_LOW_RISK|D6_MIN_EPS_SURPRISE" agentic_rag_bridge.py
grep -E "D7_MIN_DAY_RET|D7_REQUIRE_EPS_POS" agentic_rag_bridge.py
```

#### 2. æ•¸æ“šé©—è­‰
```python
# æª¢æŸ¥ eps_surprise ç¼ºå¤±ç‡
import json
with open("EarningsCallAgenticRag/backtest_checkpoints/backtest_results.json") as f:
    data = json.load(f)

eps_missing = sum(1 for r in data["results"] if r.get("eps_surprise") is None)
print(f"EPS Surprise ç¼ºå¤±: {eps_missing}/{len(data['results'])} ({eps_missing*100/len(data['results']):.1f}%)")

# æª¢æŸ¥ D4_OPP çš„ eps_surprise åˆ†ä½ˆ
d4_opp = [r for r in data["results"] if r.get("tier") == "D4_OPP"]
eps_values = [r.get("eps_surprise") for r in d4_opp if r.get("eps_surprise") is not None]
if eps_values:
    print(f"D4_OPP EPS: mean={sum(eps_values)/len(eps_values):.2f}%")
```

#### 3. ç·Šæ€¥ä¿®å¾©æ±ºç­–
é¸æ“‡ä¸€å€‹æ–¹æ¡ˆï¼š
- **æ–¹æ¡ˆ A (æ¨è–¦)**: å›æ»¾åˆ° v33 Iteration 1 ç´”æ·¨ç‰ˆæœ¬
  - ç¦ç”¨ D8_MEGA
  - å¼·åŒ– D4_OPP gates (eps_surprise >= 3%, momentum_aligned)
  - æ”¾å¯¬ D6/D7 gates
- **æ–¹æ¡ˆ B**: ä¿ç•™ D8_MEGAï¼Œåªä¿®å¾© D4_OPP/D6/D7
- **æ–¹æ¡ˆ C**: æš«åœï¼Œç­‰å¾…å®Œæ•´ v34 å¯¦æ–½

### çŸ­æœŸè¡Œå‹• (P1 - æ˜å¤©å®Œæˆ)

#### å¯¦æ–½ä¿®å¾©
```python
# å¼·åŒ– D4_OPP gates (ç„¡è«–é¸å“ªå€‹æ–¹æ¡ˆ)
def _check_d4_opp_eligible(self, direction_score, long_eligible, market_anchors):
    if direction_score < 4:
        return False

    # Momentum aligned
    day_return = market_anchors.get("earnings_day_return", 0)
    if direction_score >= 5 and day_return < 0:
        return False
    if direction_score <= 4 and day_return < -1.0:
        return False

    # EPS surprise é–€æª»
    eps_surprise = market_anchors.get("eps_surprise")
    if eps_surprise is None or eps_surprise < 3.0:  # 3% é–€æª»
        return False

    # Soft veto é™åˆ¶
    soft_veto_count = self._count_soft_vetoes(long_eligible)
    if soft_veto_count > 2:
        return False

    return True

# ä¿®å¾© D6 gates
D6_REQUIRE_LOW_RISK = False  # ç¢ºèªæ˜¯ False
D6_MIN_EPS_SURPRISE = 0.5    # ç¢ºèªæ˜¯ 0.5ï¼Œä¸æ˜¯ 5.0

# ä¿®å¾© D7 gates
D7_MIN_DAY_RET = 0.8  # å¾ 1.0 é™è‡³ 0.8
```

#### å¿«é€Ÿé©—è­‰æ¸¬è©¦
```bash
# 100 æ¨£æœ¬å¿«é€Ÿæ¸¬è©¦
MAIN_MODEL=gemini-3-flash-preview python run_incremental_backtest.py --limit 100 --workers 10

# é æœŸçµæœ: ä¿¡è™Ÿç‡ 10-20%, D4_OPP < 30%
```

### ä¸­æœŸè¡Œå‹• (P2 - æœ¬é€±å®Œæˆ)

1. **å®Œæ•´å›æ¸¬** (1000-2000 æ¨£æœ¬) ä½¿ç”¨ä¿®å¾©å¾Œé…ç½®
2. **ç¸¾æ•ˆè¨ˆç®—** ä½¿ç”¨ /backtester-api skill
3. **æ±ºç­–é»**: åŸºæ–¼çµæœæ±ºå®šæ˜¯å¦å¯¦æ–½å®Œæ•´ v34
4. **ç´™ä¸Šäº¤æ˜“æº–å‚™**: é¸æ“‡ 50 å€‹é«˜å“è³ªä¿¡è™Ÿ

### è©³ç´°åˆ†ææ–‡æª”

å®Œæ•´ Root Cause Analysis å’Œè¨ºæ–·è…³æœ¬ï¼š
- [gemini_4000_deep_analysis.md](gemini_4000_deep_analysis.md) - å®Œæ•´æ·±åº¦åˆ†æ
- [chatgpt_pro_analysis_input.md](chatgpt_pro_analysis_input.md) - åˆ†æè«‹æ±‚è¼¸å…¥
- [EarningsCallAgenticRag/backtest_checkpoints/backtest_results.json](EarningsCallAgenticRag/backtest_checkpoints/backtest_results.json) - åŸå§‹æ•¸æ“š

**çµè«–**: å¿…é ˆç«‹å³ä¿®å¾© tier gates é…ç½®æ‰èƒ½ç¹¼çºŒå›æ¸¬ã€‚ç•¶å‰ 1541 å€‹ä¿¡è™Ÿä¸å¯ç›´æ¥ç”¨æ–¼äº¤æ˜“ã€‚

---

## ç‰ˆæœ¬æ­·å²

- **V10**: ChatGPT Pro 10-iteration å„ªåŒ–ï¼Œ7-TIER æ¶æ§‹
- **V11**: Live-safe ç‰ˆæœ¬ï¼Œå¢åŠ  guardrails
- **V32**: ç”Ÿç”¢ç‰ˆæœ¬ï¼ŒD6/D7 focus
- **V33**: Iteration 1 å„ªåŒ–é…ç½® (2026-01-19)
  - CAGR: 14.16% â†’ 20.05% (+41.6%)
  - å•Ÿç”¨ D4/D5 å±¤ç´š
  - æ”¾å¯¬é¢¨éšªéæ¿¾å™¨
  - ç§»é™¤ç§‘æŠ€æ¥­é™åˆ¶
- **V34**: Rounds 6-10 ChatGPT Pro å„ªåŒ– (2026-01-19)
  - âœ… Phase 1: Prompt å„ªåŒ– (Round 6-7)
  - âœ… Phase 2: Veto Logic (Round 7) - æ–° hard/soft vetoes
  - âœ… Phase 3: Tier Gates (Round 8) - D8_MEGA + EPS surprise æ•´åˆ
  - âœ… Phase 4: Position Sizing (Round 8+10) - POSITION_SCALE=5.0, MAX_POS=40%
  - â³ Phase 5-7: Cross-validation + Data Flow + Testing
  - é æœŸ: CAGR 32-35%, Sharpe >2.0
  - ç›®å‰é€²åº¦: 62.5% (5/8 phases complete)

---

## è¯çµ¡

- Skills å•é¡Œ: ä½¿ç”¨ `/sync-skills` æ›´æ–°
- æœå‹™ç‹€æ…‹: ä½¿ç”¨ `/healthy-dashboard` æª¢æŸ¥
