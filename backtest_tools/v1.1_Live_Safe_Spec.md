# Long-only Strategy v1.1-live-safe Specification

**Version**: v1.1-live-safe (Production Ready)
**Last Updated**: 2026-01-01

---

## Executive Summary

Long-only momentum strategy based on LLM analysis of earnings transcripts. The strategy identifies stocks with strong fundamental signals and positive market reaction, entering positions one day after earnings with a 30-trading-day holding period.

---

## Strategy Parameters

### Entry/Exit Rules

| Parameter | Value | Description |
|-----------|-------|-------------|
| Decision Time | Earnings reaction day close | Make decision after market closes on earnings reaction day |
| Entry | T+1 Open | Enter at next trading session's open |
| Exit | T+31 Close | Exit 30 trading sessions after entry (at close) |
| Calendar | XNYS (NYSE) | Use NYSE trading calendar |

### Position Sizing

| Parameter | Value |
|-----------|-------|
| CAP per Quarter | 12 (First-N rule) |
| Max Concurrent Positions | 12 |
| Position Size | 1/12 = 8.33% per position |
| Allocation Method | Equal Weight |

### Friction Costs (Production)

| Parameter | Value |
|-----------|-------|
| Slippage | 10 bps |
| Commission | 2 bps |
| Total Friction | 12 bps per trade |

---

## Two-Tier Selection Rules

### Tier 1: D7 CORE (High Conviction)

Criteria:
- **Direction Score >= 7**
- **Earnings Day Return >= 1.5%**
- **EPS Positive = True** (eps_surprise > 0)

This tier captures the strongest signals where multiple LLM factors align with positive market confirmation.

### Tier 2: D6 STRICT (Additional Candidates)

Criteria:
- **Direction Score = 6**
- **Hard Positives Count >= 1** (at least one strongly positive factor)
- **Earnings Day Return >= 1.0%**

This tier adds candidates with moderate-strong signals but requires at least one decisive positive factor.

---

## LLM Signal Components

### Direction Score (0-9)

Sum of positive binary factors minus veto factors:

**Positive Factors (+1 each)**:
1. GuidanceRaised - Forward guidance increased
2. DemandAcceleration - Revenue/demand momentum
3. MarginExpansion - Improving profitability
4. FCFImprovement - Better free cash flow
5. VisibilityImproving - Clearer business outlook

**Veto Factors (-1 each)**:
1. GuidanceCut - Forward guidance reduced
2. DemandSoftness - Weakening demand signals
3. MarginWeakness - Deteriorating margins
4. CashBurn - Negative cash flow concerns
5. VisibilityWorsening - Less clarity on outlook

### Market Anchors (External Data)

| Anchor | Source | Purpose |
|--------|--------|---------|
| eps_surprise | FMP API | Beat/miss magnitude |
| earnings_day_return | Price data | Market's immediate reaction |
| pre_earnings_5d_return | Price data | Pre-earnings momentum |

---

## Guardrails (Live Trading)

### Rolling Performance Check

| Guardrail | Threshold | Action |
|-----------|-----------|--------|
| Rolling Wilson LB (N=50) | < 70% | HALT new entries |
| EPS Missing Rate | > 15% | HALT new entries |
| Max Concurrent Positions | > 12 | Skip new entries |

### Wilson Lower Bound Formula

```
WilsonLB = (phat + z²/2n - z*sqrt(phat*(1-phat)/n + z²/4n²)) / (1 + z²/n)
```

Where:
- phat = observed win rate
- n = number of trades
- z = 1.96 (95% CI)

---

## Backtest Performance (2017-2024)

### Official Metrics (SSOT - Fixed Dates Version)

| Metric | Value | 95% CI |
|--------|-------|--------|
| Total Return | 184.27% | - |
| CAGR | 14.16% | [7.15%, 21.30%] |
| Annual Vol | 7.06% | - |
| Sharpe Ratio | 1.91 | [0.91, 2.92] |
| Sortino Ratio | 3.09 | - |
| Max Drawdown | -16.95% | [-25.16%, -4.46%] |
| Calmar Ratio | 0.84 | - |

### Trade Statistics

| Metric | Value | 95% CI |
|--------|-------|--------|
| Total Trades | 180 | - |
| Win Rate | 86.11% | [81.1%, 91.1%] |
| Profit Factor | 4.06 | [2.65, 7.08] |
| Avg Trade Return | +7.33% | [+5.5%, +9.1%] |
| Avg Win | +11.29% | - |
| Avg Loss | -17.24% | - |
| Avg Exposure | 23.03% | - |

---

## Friction Sensitivity Analysis

| Slippage | Comm | Total | CAGR | Sharpe | MaxDD |
|----------|------|-------|------|--------|-------|
| 0 bps | 0 bps | 0 | 14.18% | 1.91 | -16.95% |
| 10 bps | 2 bps | 12 | 13.64% | 1.85 | -17.00% |
| 25 bps | 2 bps | 27 | 12.98% | 1.77 | -17.32% |

**Conclusion**: Strategy is robust to realistic friction costs. Even at 27 bps total cost, Sharpe remains above 1.77.

---

## Implementation Files

| File | Description |
|------|-------------|
| `signals_fixed_dates.csv` | Official signals with corrected reaction_date |
| `out_backtest_fixed/trades.csv` | Official trade records |
| `out_backtest_fixed/nav.csv` | Official daily NAV |
| `out_backtest_fixed/metrics.json` | Official performance metrics |
| `paper_trading_monitor.py` | Live paper trading script |
| `backtester.py` | Core backtest engine |

---

## Risk Considerations

1. **Tail Risk**: Max single trade loss historically -42.33%
2. **Drawdown Potential**: Block bootstrap suggests up to -25% possible
3. **Sample Size**: 180 trades provides ±5% precision on win rate
4. **Market Regime**: Strategy tested across 2018/2020/2022 volatility regimes

---

## Version History

| Version | Date | Changes |
|---------|------|---------|
| v1.0 | 2025-12 | Initial backtested version |
| v1.1-live-safe | 2026-01-01 | Fixed reaction_date alignment, added guardrails |

---

*This document is the official specification for Long-only v1.1-live-safe strategy*
